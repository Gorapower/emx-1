// Generated by CoffeeScript 1.9.1
var app, getEsta, getUser, homeController, userController;

app = angular.module('app', []);

homeController = function(scope, window) {
  scope.login = function() {
    console.log("login");
    window.location.href = '/login';
  };
  return scope.signup = function() {
    console.log("signup");
    window.location.href = '/signup';
  };
};

userController = function(scope, window, users, estas) {
  console.log('hola');
  scope.id = 1;
  scope.disponibilidad = "#000";
  scope.ubicacion = {};
  scope.cercanos = [];
  window.navigator.geolocation.getCurrentPosition(function(position) {
    return scope.ubicacion.coory = position.coords.latitude;
  });
  window.navigator.geolocation.getCurrentPosition(function(position) {
    return scope.ubicacion.coorx = position.coords.longitude;
  });
  return scope.obtener_cercanos = function() {
    return estas.getCerca(scope.ubicacion.coorx, scope.ubicacion.coory).then(function(data) {
      scope.cercanos = data;
      return console.log(scope.cercanos);
    });
  };
};

getUser = function(http) {
  var userService;
  userService = {};
  userService.getUser = function() {
    return http({
      method: 'GET',
      url: '/api/user/'
    });
  };
  return userService;
};

getEsta = function(http, window) {
  var estaService;
  estaService = {};
  estaService.getEsta = function(id) {
    return http({
      method: 'GET',
      url: '/api/estacionamiento/' + id
    });
  };
  estaService.getCerca = function(coorx, coory) {
    console.log(coorx);
    return http({
      method: 'POST',
      url: '/api/cercanos',
      data: {
        saludo: 'hola',
        xcoord: coorx,
        ycoord: coory
      }
    });
  };
  return estaService;
};

getEsta.$inject = ['$http', '$window'];

app.factory('service_getEsta', getEsta);

getUser.$inject = ['$http'];

app.factory('service_getUser', getUser);

homeController.$inject = ['$scope', '$window'];

app.controller('homeCtrl', homeController);

userController.$inject = ['$scope', '$window', 'service_getUser', 'service_getEsta'];

app.controller('userCtrl', userController);
